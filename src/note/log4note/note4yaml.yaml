#基本信息
name: lims_project_processing_date_warn_rule_lzd #规则名   ，形式必须为XXX-XXX-ruleXXX,最后一个是编号，前面的是用于实体名称
description: "项目工期报警"
mode: simple 
category: project_date    #主要用日期类，数字类别， 文本类别
run_mode: period    #规则运行方式。可选：period | realtime，默认period
cron_entry: "0 */2 * * * ?" #CRON表达式，run_mode为period时有效 用于Quarzt的定时任务执行
data_fields: #数据属性定义。用${field}引用属性值。系统预定义属性：count->数据条数，now->当前时间，用^{count}引用属性值
  - taskID
  - projectName
  - clientName
  - registerDate
  - planDate
  - status
 
  
data_format: json #数据格式，json | pojo | map
#realert: false #是否重复报警
#buffer_time:  #报警缓存时间
#alert
#获取数据
fetcher_type: api #数据获取方式，可选：api | rdb | tsdb | cache | ms | lpc | inject
fetcher_target: http://47.92.28.186:8003/hnty/lims/v1/repo/alarm_origin_info/process
fetcher_mappings:   #mapping后的添加参数
filter: taskId>0 && taskEndTime<^{now}  #数据过滤条件。 &:与，|：或， !：非
path:  
#max_query_size: #单次获取的最大记录数
#priority: #报警规则优先级

#分析匹配

analyzer_type: qlexpress #触发匹配类型：mvel(仅支持一种方式) |  any | flatline | frequency | spike | range | cardinality
expression:     时间比较(时间转换(planDate), 现在) >  7.0   &&  status!="completed"      #时间比较( 时间转换(planDate),时间转换(registerDate) ) >0.0     
#aggregation: #聚合一段时间内的警告，一起发送
#  hours: 2  # hours:小时，minutes：分钟，days：天， weeks:周
#  cron: '2 4 * * mon,fri' #周期发送
#aggregation_key: 聚合关键字

#组装发送
transmitter_type: stomp  #报警方式，可选：sms | email | db | stomp | api | lpc | debug | custom ...
transmitter_style: origion # 两种，原始信息或者  包装信息
#transmitter_name: com.hnty.alerter.CustomAlerter #自定义报警器，alerter_type为custom时有效
#wrapper: 尊敬的${userName}，您有新的任务等待完成，任务名[${taskName}]，截止时间[${taskEndTime}] #报警内容
wrapper: 尊敬的{subscriptions}，当前项目编号{taskID}，项目名称{projectName}，委托方客户是{clientName}，项目登记时间为{registerDate}， 按协议应该于{planDate}前完成，检测项目进度滞后{$时间差(planDate)}天，请关注   
subscriptions: #报警订阅者
  - /alert/warn
  #- {phoneNumber}
  
# Sequence of Scalars  简单数据列表
- Mark McGwire
- Sammy Sosa
- Ken Griffey

# Mapping Scalars to Scalars 简单的额数据键值对以及注释
hr: 65
avg: 0.278
rbi: 147

# Mapping Scalars to Sequences 简单数据列表键值对
american:
  - Boston Red Sox
  - Detroit Tigers
  - New York Yankees
national:
  - New York Mets
  - Chicago Cubs
  - Atlanta Braves
# Sequence of Mappings 键值对列表 
-
  name: Mark McGwire
  hr:   65
  avg:  0.278
-
  name: Sammy Sosa
  hr:   63
  avg:  0.288

# YAML 还支持流类型，用中括号括起来表示列表，用逗号分隔元素；用大括号括起来表示键值对，用逗号分隔元素。
# Sequence of Sequences 列表的列表 
- [name        , hr, avg  ]
- [Mark McGwire, 65, 0.278]
- [Sammy Sosa  , 63, 0.288]

#  Mapping of Mappings  键值对的键值对
Mark McGwire: {hr: 65, avg: 0.278}
Sammy Sosa: {
    hr: 63,
    avg: 0.288
  }
